---
title: 'Homework #3'
author: "Sneha Mehta"
date: "2022-10-15"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
```

## Problem 1




## Problem 2
```{r prob 2 part 1}
accel_data = read_csv("./accel_data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(day_type = ifelse(day == "Saturday" | day == "Sunday", "weekend", "weekday")) %>% 
  relocate(day_type, .after = day) %>% 
  pivot_longer(activity_1:activity_1440,
               names_to = "minute",
               names_prefix = "activity_",
               values_to = "activity_count") %>% 
  mutate(minute = as.numeric(minute))
```
This dataset describes five weeks of accelerometer data collected from a 63 year old male with BMI 25. Activity counts were collected each minute of the days. The tidied dataset has 50,400 observations across six variables: the week and day of data collection (day is listed numerically, by day of the week, and classified as a weekday or weekend), the minute of the day the activity count was collected, and the activity count.

```{r prob 2 part 2}
accel_data_sum = accel_data %>% 
  group_by(week, day) %>% 
  summarise(day_activity_total = sum(activity_count)) %>% 
  pivot_wider(
    names_from = day,
    values_from = day_activity_total) %>% 
  select("week", "Monday","Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")

accel_data_sum %>% group_by() %>% 
  summarise(across(Monday:Sunday, mean)) %>% view()
```

On average, Saturdays had the lowest activity counts for the individual. Wednesdays - Fridays had the highest.

```{r prob 2 part 3}
ggplot(accel_data, aes(x = minute/60, y = activity_count)) + geom_point(aes(color = day), alpha = 0.5) + geom_smooth() + labs(
  title = "Daily Activity Levels",
  x = "Hour",
  y = "Activity Count"
)
```
From this plot, we can see that most activity for this person took place between ~8:00 - ~21:00 hours each day. Activity dipped quite sharply at around 21:00 hours each day and gradually rose from ~5:00 to ~9:00 hours and mostly plateaued for the middle part of each day.

## Problem 3

```{r prob 3 part 0}
library(p8105.datasets)
data("ny_noaa") 
```
This dataset has 2,595,176 observations across 7 variables. It contains data from all New York state weather stations across 5 metrics: precipitation, snowfall, snow depth, maximum temperature, and minimum temperature. It also includes date of observation and the id number of the weather station. There are large amounts of missing observations across all 5 of the measurement metrics.

```{r prob 3 part 1}
ny_noaa = ny_noaa %>% 
  separate(date, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>% 
  mutate(tmax = as.numeric(tmax)/10, 
         tmin = as.numeric(tmin)/10,
         prcp = prcp/10)

table(ny_noaa$snow)
sort(table(ny_noaa$snow), decreasing = TRUE) %>% view()
```
The most commonly observed value for snowfall is 0mm due to the fact that the snowy season is mainly concentrated in a few months (Dec-Feb) (and even then it doesn't snow every day).


```{r prob 3 part 2}
ny_noaa %>% 
  filter(month == 1 | month == 7) %>% mutate(month = case_when(month == 1 ~ "January",
                                                               month == 7 ~ "July")) %>% 
  group_by(id, year, month) %>% 
  mutate(avgtmax = mean(tmax)) %>% 
  ggplot(aes(x = year, y = avgtmax)) + geom_line(aes(color = id), alpha = 0.5) + facet_grid(.~ month) + theme(legend.position = "none") + labs(
  title = "Average Max. Temperature by Month per Station",
  x = "Time",
  y = "Average Max. Temp"
)
```
From the plots, we can see that the average temperature in January is ~27 degrees lower than the average temperature in July. The temperatures in January generally range between around -10 to 10 degrees Celsius, and in July, the temperatures generally range from 20-35 degrees Celcius. In July, we can see one obvious outlier where in ~1988 one station recorded temperatures around 15 degrees.
